# Contents

- [CaseInsensitive.js](#caseinsensitivejs)
- [DomXss.vue](#domxssvue)



## [CaseInsensitive.js](../../examples/insecure/js/CaseInsensitive.js)
Path: `/examples/insecure/js/CaseInsensitive.js`

### Explanation
The issue arises because the `startsWith` method is **not case-sensitive**. This means that requests like `/api` or `/ApI` can bypass authentication checks. 

The vulnerability is introduced on line 6:  
- If the path starts with `/api`, an authentication check is performed (line 7).  
- However, if the path does not start with `/api`, the code skips authentication and moves directly to the `next` function (line 13).  
- If a payload like `target.com/./ApI` is provided:  
1. The `next` function normalizes the path.  
2. Since there is no self-loop or further validation, the request bypasses all authentication and is processed without any checks.

&nbsp;

## [DomXss.vue](../../examples/insecure/js/DomXss.vue)

Path: `/examples/insecure/js/DomXss.vue`

### Explanation

The data comes from Vue Router where `$route` represents the current URL. Depending on the routing mode, `$route.query` either comes from the current URL's query parameters or from the URL's hash portion and we could now inject arbitrary attributes into the `PageContent` component, including JavaScript event handlers.

#### Exploit:

The spinner animation defined in the CSS section of the code snippet is useful. Since the animation is already defined, it can be harnessed in a `style` attribute and arbitrary JavaScript can be inserted into the `onanimationstart` event handler. When the page loads, the animation starts, triggering the event handler and executing the injected JavaScript.

The final malicious URL looks like this:

```bash
http://site.com/#/?style=animation-name:spinner&onanimationstart=alert(1)
```

&nbsp;
